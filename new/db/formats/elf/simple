NAME=ELF: long symbol names
FILE=../bins/elf/analysis/longsym
EXPECT64=MTk0Cgo=
CMDS64=P2xxIGBpc3F+cGF0YWA7P3ZpCg==
RUN
NAME=ELF: simple.elf - code
FILE=../bins/elf/analysis/simple.elf
EXPECT64=MHgwODAwMDA2MCAgICBzZWN0aW9uLi50ZXh0OgoweDA4MDAwMDYwICAgICAgICAgICBiOTkwMDAwMDA4ICBtb3YgZWN4LCAweDgwMDAwOTAKMHgwODAwMDA2NSAgICAgICAgICAgYmEwZDAwMDAwMCAgbW92IGVkeCwgMHhkCjB4MDgwMDAwNmEgICAgICAgICAgIGJiMDEwMDAwMDAgIG1vdiBlYngsIDEKMHgwODAwMDA2ZiAgICAgICAgICAgYjgwNDAwMDAwMCAgbW92IGVheCwgNAoK
CMDS64=ZSBhc20uZmlsdGVyPWZhbHNlCnBpZCA0IEAgZW50cnkwCg==
RUN
NAME=ELF: asm.flags.middle=0 + local symbols
FILE=../bins/elf/analysis/example.elf
EXPECT64=ICAgICAgICA6ICAgMHgwMDAwMDM1NiAgICAgIDAwZjAzM2Y5ICAgICAgIGJsIHN5bS5hcHBfdWFydF9nZXQKICAgICAgICA6ICAgMHgwMDAwMDM1YSAgICAgIDAwMjggICAgICAgICAgIGNtcCByMCwgMAogICAgICAgIGA9PCAweDAwMDAwMzVjICAgICAgZmFkMSAgICAgICAgICAgYm5lIDB4MzU0Cgo=
CMDS64=ZSBhc20uZmxhZ3MubWlkZGxlPTA7cGQgMyBAIDB4MzU2Cg==
RUN
NAME=ELF: asm.flags.middle=1 + local symbols
FILE=../bins/elf/analysis/example.elf
EXPECT64=ICAgICAgICA6ICAgOy0tICRkOgogICAgICAgIDogICAweDAwMDAwMzU2ICB+ICAgMDBmMDMzZjkgICAgICAgYmwgc3ltLmFwcF91YXJ0X2dldAogICAgICAgIDogICAweDAwMDAwMzVhICAgICAgMDAyOCAgICAgICAgICAgY21wIHIwLCAwCiAgICAgICAgYD08IDB4MDAwMDAzNWMgICAgICBmYWQxICAgICAgICAgICBibmUgMHgzNTQKCg==
CMDS64=ZSBhc20uZmxhZ3MubWlkZGxlPTE7cGQgMyBAIDB4MzU2Cg==
RUN
NAME=ELF: asm.flags.middle + local symbols
FILE=../bins/elf/analysis/example.elf
EXPECT64=ICAgICAgICA6ICAgMHgwMDAwMDM1NiAgfiAgIDAwZjAzM2Y5ICAgICAgIGJsIHN5bS5hcHBfdWFydF9nZXQKICAgICAgICA6ICAgMHgwMDAwMDM1YSAgICAgIDAwMjggICAgICAgICAgIGNtcCByMCwgMAogICAgICAgIGA9PCAweDAwMDAwMzVjICAgICAgZmFkMSAgICAgICAgICAgYm5lIDB4MzU0Cgo=
CMDS64=cGQgMyBAIDB4MzU2Cg==
RUN
NAME=ELF: asm.flags.middle2 + local symbols
FILE=../bins/elf/analysis/example.elf
EXPECT64=ICAgICAgICA6ICAgMHgwMDAwMDM1NiAgICAgIDAwZjAzM2Y5ICAgICAgIGJsIHN5bS5hcHBfdWFydF9nZXQKICAgICAgICA6ICAgMHgwMDAwMDM1YSAgICAgIDAwMjggICAgICAgICAgIGNtcCByMCwgMAogICAgICAgIGA9PCAweDAwMDAwMzVjICAgICAgZmFkMSAgICAgICAgICAgYm5lIDB4MzU0Cgo=
CMDS64=ZSBhc20uZmxhZ3MubWlkZGxlPTAKcGQgMyBAIDB4MzU2Cg==
RUN
NAME=ELF: local symbols
FILE=../bins/elf/analysis/example.elf
EXPECT64=ZiBzeW0uZF80MSAwIDB4MDAwMDBhZTAKCg==
CMDS64=aXMqfmRfNDEK
RUN
NAME=ELF: phdr override
FILE=../bins/elf/analysis/phdr-override
EXPECT64=c3lzdGVtCl9fbGliY19zdGFydF9tYWluCl9fZ21vbl9zdGFydF9fCl9fZ21vbl9zdGFydF9fCgo=
CMDS64=aWlxCg==
RUN
NAME=ELF: phdr override 2
FILE=../bins/elf/busybox-phdr-shdr
EXPECT64=ICAgNyAweDAwNDAwMDAwICBHTE9CQUwgICAgIE9CSiBfX2Vudmlyb24KICA0MyAweDAwNDAwMDAwICBHTE9CQUwgICAgIE9CSiBfX2N0eXBlX3RvbG93ZXIKIDE0NSAweDAwNDAwMDAwICBHTE9CQUwgICAgIE9CSiBfX3N0ZG91dAogMTg5IDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIHN0ZGVycgogNDA5IDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIHN0ZGluCiA0MTAgMHgwMDQwMDAwMCAgR0xPQkFMICAgICBPQkogX19zdGRpbgogNDE3IDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIG9wdGluZAogNDY4IDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIGVudmlyb24KIDU4OCAweDAwNDAwMDAwICBHTE9CQUwgICAgIE9CSiBvcHRhcmcKIDY2NyAweDAwNDAwMDAwICBHTE9CQUwgICAgIE9CSiBfX2N0eXBlX2IKIDcwNiAweDAwNDAwMDAwICBHTE9CQUwgICAgIE9CSiBhbGxDb3VudHJ5TGlzdAogNzE4IDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIHN0ZG91dAogICA3IDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIF9fZW52aXJvbgogIDQzIDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIF9fY3R5cGVfdG9sb3dlcgogMTQ1IDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIF9fc3Rkb3V0CiAxODkgMHgwMDQwMDAwMCAgR0xPQkFMICAgICBPQkogc3RkZXJyCiA0MDkgMHgwMDQwMDAwMCAgR0xPQkFMICAgICBPQkogc3RkaW4KIDQxMCAweDAwNDAwMDAwICBHTE9CQUwgICAgIE9CSiBfX3N0ZGluCiA0MTcgMHgwMDQwMDAwMCAgR0xPQkFMICAgICBPQkogb3B0aW5kCiA0NjggMHgwMDQwMDAwMCAgR0xPQkFMICAgICBPQkogZW52aXJvbgogNTg4IDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIG9wdGFyZwogNjY3IDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIF9fY3R5cGVfYgogNzA2IDB4MDA0MDAwMDAgIEdMT0JBTCAgICAgT0JKIGFsbENvdW50cnlMaXN0CiA3MTggMHgwMDQwMDAwMCAgR0xPQkFMICAgICBPQkogc3Rkb3V0Cgo=
CMDS64=aWl+T0JKCg==
RUN
