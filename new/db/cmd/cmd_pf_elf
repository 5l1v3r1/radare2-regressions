NAME=32: Elf header size
FILE=malloc://1024
EXPECT64=NTIK
CMDS64=cGZvIGVsZjMyCnBmcy5lbGZfaGVhZGVyCgo=
RUN
NAME=64: Elf header size
FILE=malloc://1024
EXPECT64=NjQK
CMDS64=cGZvIGVsZjY0CnBmcy5lbGZfaGVhZGVyCgo=
RUN
NAME=32: Elf program header size
FILE=malloc://1024
EXPECT64=MzIK
CMDS64=cGZvIGVsZjMyCnBmcy5lbGZfcGhkcgoK
RUN
NAME=64: Elf program header size
FILE=malloc://1024
EXPECT64=NTYK
CMDS64=cGZvIGVsZjY0CnBmcy5lbGZfcGhkcgoK
RUN
NAME=32: Elf section header size
FILE=malloc://1024
EXPECT64=NDAK
CMDS64=cGZvIGVsZjMyCnBmcy5lbGZfc2hkcgoK
RUN
NAME=64: Elf section header size
FILE=malloc://1024
EXPECT64=NjQK
CMDS64=cGZvIGVsZjY0CnBmcy5lbGZfc2hkcgoK
RUN
NAME=32: Multiple section headers
FILE=malloc://1024
EXPECT64=IHNlY3Rpb25zIDogClsKICAgICAgICAgICAgICAgIHN0cnVjdDxlbGZfc2hkcj4KICAgICAgICAgICAgICAgIG5hbWUgOiAweDAwMDAwMDAwID0gMHgwMDAwMDAwMAogICAgICAgICAgICAgICAgdHlwZSA6IDB4MDAwMDAwMDQgPSB0eXBlIChlbnVtIGVsZl9zX3R5cGUpID0gMHgwIDsgU0hUX05VTEwKICAgICAgICAgICAgICAgZmxhZ3MgOiAweDAwMDAwMDA4ID0gZmxhZ3MgKGVudW0gZWxmX3NfZmxhZ3NfMzIpID0gMHgwIDsgU0YzMl9Ob25lCiAgICAgICAgICAgICAgICBhZGRyIDogMHgwMDAwMDAwYyA9IDB4MDAwMDAwMDAKICAgICAgICAgICAgICBvZmZzZXQgOiAweDAwMDAwMDEwID0gMHgwMDAwMDAwMAogICAgICAgICAgICAgICAgc2l6ZSA6IDB4MDAwMDAwMTQgPSAweDAwMDAwMDAwCiAgICAgICAgICAgICAgICBsaW5rIDogMHgwMDAwMDAxOCA9IDB4MDAwMDAwMDAKICAgICAgICAgICAgICAgIGluZm8gOiAweDAwMDAwMDFjID0gMHgwMDAwMDAwMAogICAgICAgICAgIGFkZHJhbGlnbiA6IDB4MDAwMDAwMjAgPSAweDAwMDAwMDAwCiAgICAgICAgICAgICBlbnRzaXplIDogMHgwMDAwMDAyNCA9IDB4MDAwMDAwMDAKCiAgICAgICAgICAgICAgICBzdHJ1Y3Q8ZWxmX3NoZHI+CiAgICAgICAgICAgICAgICBuYW1lIDogMHgwMDAwMDAyOCA9IDB4MDAwMDAwMDAKICAgICAgICAgICAgICAgIHR5cGUgOiAweDAwMDAwMDJjID0gdHlwZSAoZW51bSBlbGZfc190eXBlKSA9IDB4MCA7IFNIVF9OVUxMCiAgICAgICAgICAgICAgIGZsYWdzIDogMHgwMDAwMDAzMCA9IGZsYWdzIChlbnVtIGVsZl9zX2ZsYWdzXzMyKSA9IDB4MCA7IFNGMzJfTm9uZQogICAgICAgICAgICAgICAgYWRkciA6IDB4MDAwMDAwMzQgPSAweDAwMDAwMDAwCiAgICAgICAgICAgICAgb2Zmc2V0IDogMHgwMDAwMDAzOCA9IDB4MDAwMDAwMDAKICAgICAgICAgICAgICAgIHNpemUgOiAweDAwMDAwMDNjID0gMHgwMDAwMDAwMAogICAgICAgICAgICAgICAgbGluayA6IDB4MDAwMDAwNDAgPSAweDAwMDAwMDAwCiAgICAgICAgICAgICAgICBpbmZvIDogMHgwMDAwMDA0NCA9IDB4MDAwMDAwMDAKICAgICAgICAgICBhZGRyYWxpZ24gOiAweDAwMDAwMDQ4ID0gMHgwMDAwMDAwMAogICAgICAgICAgICAgZW50c2l6ZSA6IDB4MDAwMDAwNGMgPSAweDAwMDAwMDAwCl0KCg==
CMDS64=cGZvIGVsZjMyCnBmIFsyXT8gKGVsZl9zaGRyKXNlY3Rpb25zCgo=
RUN
NAME=64: Multiple section headers
FILE=malloc://1024
EXPECT64=IHNlY3Rpb25zIDogClsKICAgICAgICAgICAgICAgIHN0cnVjdDxlbGZfc2hkcj4KICAgICAgICAgICAgICAgIG5hbWUgOiAweDAwMDAwMDAwID0gMHgwMDAwMDAwMAogICAgICAgICAgICAgICAgdHlwZSA6IDB4MDAwMDAwMDQgPSB0eXBlIChlbnVtIGVsZl9zX3R5cGUpID0gMHgwIDsgU0hUX05VTEwKICAgICAgICAgICAgICAgZmxhZ3MgOiAweDAwMDAwMDA4ID0gZmxhZ3MgKGVudW0gZWxmX3NfZmxhZ3NfNjQpID0gMHgwIDsgU0Y2NF9Ob25lCiAgICAgICAgICAgICAgICBhZGRyIDogMHgwMDAwMDAxMCA9IChxd29yZCkweDAwMDAwMDAwMDAwMDAwMDAKICAgICAgICAgICAgICBvZmZzZXQgOiAweDAwMDAwMDE4ID0gKHF3b3JkKTB4MDAwMDAwMDAwMDAwMDAwMAogICAgICAgICAgICAgICAgc2l6ZSA6IDB4MDAwMDAwMjAgPSAocXdvcmQpMHgwMDAwMDAwMDAwMDAwMDAwCiAgICAgICAgICAgICAgICBsaW5rIDogMHgwMDAwMDAyOCA9IDB4MDAwMDAwMDAKICAgICAgICAgICAgICAgIGluZm8gOiAweDAwMDAwMDJjID0gMHgwMDAwMDAwMAogICAgICAgICAgIGFkZHJhbGlnbiA6IDB4MDAwMDAwMzAgPSAocXdvcmQpMHgwMDAwMDAwMDAwMDAwMDAwCiAgICAgICAgICAgICBlbnRzaXplIDogMHgwMDAwMDAzOCA9IChxd29yZCkweDAwMDAwMDAwMDAwMDAwMDAKCiAgICAgICAgICAgICAgICBzdHJ1Y3Q8ZWxmX3NoZHI+CiAgICAgICAgICAgICAgICBuYW1lIDogMHgwMDAwMDA0MCA9IDB4MDAwMDAwMDAKICAgICAgICAgICAgICAgIHR5cGUgOiAweDAwMDAwMDQ0ID0gdHlwZSAoZW51bSBlbGZfc190eXBlKSA9IDB4MCA7IFNIVF9OVUxMCiAgICAgICAgICAgICAgIGZsYWdzIDogMHgwMDAwMDA0OCA9IGZsYWdzIChlbnVtIGVsZl9zX2ZsYWdzXzY0KSA9IDB4MCA7IFNGNjRfTm9uZQogICAgICAgICAgICAgICAgYWRkciA6IDB4MDAwMDAwNTAgPSAocXdvcmQpMHgwMDAwMDAwMDAwMDAwMDAwCiAgICAgICAgICAgICAgb2Zmc2V0IDogMHgwMDAwMDA1OCA9IChxd29yZCkweDAwMDAwMDAwMDAwMDAwMDAKICAgICAgICAgICAgICAgIHNpemUgOiAweDAwMDAwMDYwID0gKHF3b3JkKTB4MDAwMDAwMDAwMDAwMDAwMAogICAgICAgICAgICAgICAgbGluayA6IDB4MDAwMDAwNjggPSAweDAwMDAwMDAwCiAgICAgICAgICAgICAgICBpbmZvIDogMHgwMDAwMDA2YyA9IDB4MDAwMDAwMDAKICAgICAgICAgICBhZGRyYWxpZ24gOiAweDAwMDAwMDcwID0gKHF3b3JkKTB4MDAwMDAwMDAwMDAwMDAwMAogICAgICAgICAgICAgZW50c2l6ZSA6IDB4MDAwMDAwNzggPSAocXdvcmQpMHgwMDAwMDAwMDAwMDAwMDAwCl0KCg==
CMDS64=cGZvIGVsZjY0CnBmIFsyXT8gKGVsZl9zaGRyKXNlY3Rpb25zCgo=
RUN
NAME=Issue 5640 pfj produce wrong json
FILE=../bins/elf/analysis/main
EXPECT64=W3sibmFtZSI6IiIsInR5cGUiOiJlbGZfcGhkciIsIm9mZnNldCI6NjQsInZhbHVlIjpbeyJuYW1lIjoidHlwZSIsInR5cGUiOiJFIiwib2Zmc2V0Ijo2NCwidmFsdWUiOiJlbGZfcF90eXBlIn0seyJuYW1lIjoiZmxhZ3MiLCJ0eXBlIjoiRSIsIm9mZnNldCI6NjgsInZhbHVlIjoiZWxmX3BfZmxhZ3MifSx7Im5hbWUiOiJvZmZzZXQiLCJ0eXBlIjoicSIsIm9mZnNldCI6NzIsInZhbHVlIjo2NH0seyJuYW1lIjoidmFkZHIiLCJ0eXBlIjoicSIsIm9mZnNldCI6ODAsInZhbHVlIjo0MTk0MzY4fSx7Im5hbWUiOiJwYWRkciIsInR5cGUiOiJxIiwib2Zmc2V0Ijo4OCwidmFsdWUiOjQxOTQzNjh9LHsibmFtZSI6ImZpbGVzeiIsInR5cGUiOiJxIiwib2Zmc2V0Ijo5NiwidmFsdWUiOjQ0OH0seyJuYW1lIjoibWVtc3oiLCJ0eXBlIjoicSIsIm9mZnNldCI6MTA0LCJ2YWx1ZSI6NDQ4fSx7Im5hbWUiOiJhbGlnbiIsInR5cGUiOiJxIiwib2Zmc2V0IjoxMTIsInZhbHVlIjo4fV19XQoK
ARGS=-nn
CMDS64=cGZqIHsxfT8gKGVsZl9waGRyKSBAIDB4MDAwMDAwMDAwMDAwMDA0MAoK
RUN
