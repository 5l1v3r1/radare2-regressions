NAME=Function labels in comments
FILE=malloc://512
EXPECT64=fCAgICAgICBgPTwgMDAwMDowMDBkICAgICBlMmZhICAgbG9vcCA5IDsgZmNuMS5sb29wMQoK
CMDS64=ZSBhc20uYXJjaD14ODYKZSBhc20uYml0cz0xNgplIGFzbS5uYnl0ZXM9MgplIGFzbS5jbXQuY29sPTAKd3ggNjZiODAxMDAwMDAwYjkwZjAwNjY4M2ZiMDJlMmZhNjZiYjAxMDAwMDAwYzMKYWYrIDAwMDA6MDAwMCBmY24xCmFmYisgMCAwIDIyCmYgLmxvb3AxIEAgMDAwMDowMDA5CnBkIDEgQCAwMDAwOjAwMGQK
RUN
NAME=Function labels in disasm
FILE=malloc://512
EXPECT64=fCAgICAgICAgICAgIC5sb29wMToKfCAgICAgICAgICAgMDAwMDowMDA5ICAgICA2NjgzLiAgY21wIGVieCwgMgoK
CMDS64=CmUgYXNtLmFyY2g9eDg2CmUgYXNtLmJpdHM9MTYKZSBhc20ubmJ5dGVzPTIKd3ggNjZiODAxMDAwMDAwYjkwZjAwNjY4M2ZiMDJlMmZhNjZiYjAxMDAwMDAwYzMKYWYrIDAgZm5jMQphZmIrIDAgMCAyMgpmIC5sb29wMSBAIDkKcGQgMSBAIDkKCg==
RUN

NAME=ANSI injection vuln
FILE=../bins/mach0/ansi
CMDS=<<EOF
sp
e asm.lines=0
e asm.comments=0
pd 1
isq
EOF
EXPECT=<<EOF
;-- section.0.__TEXT.__text:
;-- _rt:
;-- func.100000f50:
0x100000f50      55             push rbp
0x100000000 0 __mh_execute_header
0x100000f60 0 _main
0x100000f50 0 _r\x1b#8qt
0x100000f8a 0 imp.printf
0x100000f50 0 func.100000f50
0x100000f60 0 func.100000f60
EOF
RUN
