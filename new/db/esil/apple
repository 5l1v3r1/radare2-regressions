NAME=iphone-arm-esil tests
FILE=../bins/mach0/FileDP
EXPECT64=ICAgICAgICAgICAgMHgwMDAwMjhlYyAgICAgIGIwNDAyZGU5ICAgICAgIHB1c2gge3I0LCByNSwgcjcsIGxyfSAgICAgICA7IHNwPTB4MTc3ZmYwCiAgICAgICAgICAgIDB4MDAwMDI4ZjAgICAgICAwODcwOGRlMiAgICAgICBhZGQgcjcsIHNwLCA4ICAgICAgICAgICAgICAgOyByNz0weDE3N2ZmOAogICAgICAgICAgICAweDAwMDAyOGY0ICAgICAgMDVkZDRkZTIgICAgICAgc3ViIHNwLCBzcCwgMHgxNDAgICAgICAgICAgIDsgc3A9MHgxNzdlYjAKICAgICAgICAgICAgMHgwMDAwMjhmOCAgICAgIDA3ZDBjZGUzICAgICAgIGJpYyBzcCwgc3AsIDcgICAgICAgICAgICAgICA7IHNwPTB4MTc3ZWIwCgo=
CMDS64=cyBtYWluCmFlaQphZWltCmUgYXNtLmVtdT10cnVlCmUgYXNtLmVtdXN0cj1mYWxzZQpwZCA0fiEtLQoK
RUN
NAME=iphone-arm-esil pdsf
FILE=../bins/mach0/FileDP
EXPECT64=MHgwMDAwMjkxOCAiYWxsb2MiCjB4MDAwMDI5MjAgYXJnMgoweDAwMDAyOTIwIHN0ci5hbGxvYwoweDAwMDAyOTI4IGJsIHN5bS5pbXAub2JqY19tc2dTZW5kCjB4MDAwMDI5MzQgImluaXQiCjB4MDAwMDI5M2MgYXJnMgoweDAwMDAyOTNjIHN0ci5pbml0CjB4MDAwMDI5NDAgYmwgc3ltLmltcC5vYmpjX21zZ1NlbmQKMHgwMDAwMjk0YyAiWFx4MTBceDlkXHhlNSIKMHgwMDAwMjk1OCBhcmcyCjB4MDAwMDI5NWMgYmwgc3ltLmltcC5vYmpjX21zZ1NlbmQKMHgwMDAwMjk2OCBhcmcxCjB4MDAwMDI5NzAgYmwgc3ltLmltcC5vYmpjX21zZ1NlbmQKMHgwMDAwMjk5OCAiVXNhZ2U6IEZpbGVEUCBbLWYvLWRdIFtGdWxsIHBhdGggdG8gZmlsZS9kaXJlY3RvcnldICIKMHgwMDAwMjk5YyBibCBzeW0uaW1wLnB1dHMKMHgwMDAwMmU5MCBbMDJdIC1yLXggc2VjdGlvbiBzaXplIDE0OSBuYW1lZCAyLl9fVEVYVC5fX2NzdHJpbmcKMHgwMDAwMjliYyBhcmcyCjB4MDAwMDI5YzggYmwgc3ltLmltcC5zdHJjbXAKMHgwMDAwMjlmNCBhcmczCjB4MDAwMDI5ZjggYXJnMwoweDAwMDAyOWZjIGFyZzMKMHgwMDAwMmEwMCBhcmczCjB4MDAwMDJhMWMgYmwgc3ltLmltcC5vYmpjX21zZ1NlbmQKMHgwMDAwMmEzOCBibCBzeW0uaW1wLm9iamNfbXNnU2VuZAoweDAwMDAyYTY0IGJsIHN5bS5pbXAub2JqY19tc2dTZW5kCjB4MDAwMDJhODAgYXJnMQoweDAwMDAyYTkwIGJsIHN5bS5pbXAub2JqY19tc2dTZW5kCjB4MDAwMDJhYTQgYmwgc3ltLmltcC5OU0xvZwoweDAwMDAyYWIwIHN0ci5GaWxlX05vdF9Gb3VuZAoweDAwMDAyYWI0IGJsIHN5bS5pbXAucHV0cwoweDAwMDAyYWQ4IGFyZzMKMHgwMDAwMmFkYyBhcmczCjB4MDAwMDJhZTAgYXJnMwoweDAwMDAyYWU0IGFyZzMKMHgwMDAwMmIwMCBibCBzeW0uaW1wLm9iamNfbXNnU2VuZAoweDAwMDAyYjFjIGJsIHN5bS5pbXAub2JqY19tc2dTZW5kCjB4MDAwMDJiNDggYmwgc3ltLmltcC5vYmpjX21zZ1NlbmQKMHgwMDAwMmI2NCBibCBzeW0uaW1wLm9iamNfbXNnU2VuZAoweDAwMDAyYmE0IGJsIHN5bS5pbXAub2JqY19tc2dTZW5kCjB4MDAwMDJjMDAgYmwgc3ltLmltcC5vYmpjX21zZ1NlbmQKMHgwMDAwMmMyMCBhcmcxCjB4MDAwMDJjMzQgYXJnMQoweDAwMDAyYzU0IGJsIHN5bS5pbXAub2JqY19lbnVtZXJhdGlvbk11dGF0aW9uCjB4MDAwMDJjNjAgYXJnMQoweDAwMDAyYzY0IGFyZzEKMHgwMDAwMmM2OCBhcmcxCjB4MDAwMDJjNmMgYXJnMQoweDAwMDAyY2EwIGJsIHN5bS5pbXAub2JqY19tc2dTZW5kCjB4MDAwMDJjYzAgYmwgc3ltLmltcC5vYmpjX21zZ1NlbmQKMHgwMDAwMmNkYyBhcmcxCjB4MDAwMDJjZWMgYmwgc3ltLmltcC5vYmpjX21zZ1NlbmQKMHgwMDAwMmNmYyBzdHIuY3N0ci5maWxlX25hbWVfaXM6X19fX19wcm90ZWN0aW9uX2NsYXNzOgoweDAwMDAyZDA0IGJsIHN5bS5pbXAuTlNMb2cKMHgwMDAwMmQ1MCBibCBzeW0uaW1wLm9iamNfbXNnU2VuZAoweDAwMDAyZDg0IHN0ci5EaXJlY3RvcnlfTm90X2ZvdW5kCjB4MDAwMDJkODggYmwgc3ltLmltcC5wdXRzCjB4MDAwMDJkYWMgYmwgc3ltLmltcC5vYmpjX21zZ1NlbmQKMHgwMDAwMmRjYyBieCBscgo=
CMDS64=ZSBhc20uZmxhZ3M9ZmFsc2UKcyBtYWluCmUgaW8uc2VjdG9ubHk9dHJ1ZQplIGFzbS5lbXU9dHJ1ZQplIGFzbS5lbXVzdHI9dHJ1ZQphZgpwZHNmCgo=
RUN
NAME=sectonly esil stack
FILE=../bins/mach0/FileDP
EXPECT64=MHgwMDE3ODAwMCAweDAwMDAwMDAwIHNiCjB4MDAxNzgwMDAgMHgwMDAwMDAwMCBzYgoweDAwMTc4MDAwIDB4MDAwMDAwMDAgc2IKCg==
CMDS64=cyBtYWluCmFlaQphZWltCmUgYXNtLmVtdT10cnVlCmUgYXNtLmVtdXN0cj10cnVlCmUgaW8uc2VjdG9ubHk9ZmFsc2UKLmFyKgpweFcgNCBAIHNwCmUgaW8uc2VjdG9ubHk9dHJ1ZQpweFcgNCBAIHNwClMgMCAweDEwMDAwMCAwIDk4MzA0MCBzdGFjayBydy0gMApweFcgNCBAIHNwCgo=
RUN
NAME=thumb emulation arm issue
FILE=../bins/mach0/FileDP
EXPECT64=MzIKCg==
CMDS64=YWVzCmUgYXNtLmJpdHMK
RUN
NAME=string refs: thumb
FILE=../bins/mach0/test-thumb
EXPECT64=NgoK
CMDS64=YWYKZSBhc20uZW11PXRydWUKZSBhc20uZW11c3RyPXRydWUKcGRmfj9zdHIuc3RyaW5nCgo=
RUN
NAME=string refs: arm32
FILE=../bins/mach0/test-arm32
EXPECT64=NgoK
CMDS64=YWYKZSBhc20uZW11PXRydWUKZSBhc20uZW11c3RyPXRydWUKcGRmfj9zdHIuc3RyaW5nCgo=
RUN
NAME=string refs: arm64
FILE=../bins/mach0/test-arm64
EXPECT64=NgoK
CMDS64=YWYKZSBhc20uZW11PXRydWUKZSBhc20uZW11c3RyPXRydWUKcGRmfj9zdHIuc3RyaW5nCgo=
RUN
NAME=arm32: thumb
FILE=../bins/mach0/arm32-ofp.lzh
EXPECT64=MQoK
CMDS64=cGQgMn4/cHVzaAoK
RUN
NAME=thumb: arm32
FILE=../bins/mach0/arm16-ofp.lzh
EXPECT64=MQoK
CMDS64=cGQgMn4/cHVzaAoK
RUN
