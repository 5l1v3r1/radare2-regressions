#!/bin/sh
for a in . .. ../.. ; do [ -e $a/tests.sh ] && . $a/tests.sh ; done


NAME='ragg2 -p A200 -d 50:0xccccccb'
CMDS='!ragg2 -p A200 -d 50:0xccccccb'
EXPECT='4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141cbcccc0c4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141
'
run_test

NAME='ragg2 -p A200 -d 50:0xcb'
CMDS='!ragg2 -p A200 -d 50:0xcb'
EXPECT='4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141cb0000004141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141
'
run_test

NAME='ragg2 -p A10 -d 50:0xcb'
CMDS='!ragg2 -p A10 -d 50:0xcb'
EXPECT_ERR="Fuck this shit. Cant patch outside"
EXPECT='41414141414141414141
'
run_test

NAME='ragg2 -p A20 -w 10:cb'
CMDS='!ragg2 -p A20 -w 10:cb'
BROKEN=1
EXPECT='414141414141414141cb41414141414141414141
'
run_test

NAME='ragg2 -i exec -z -a x86 -b32'
CMDS='!ragg2 -i exec -z -a x86 -b32'
BROKEN=
EXPECT='"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80"
'
run_test


NAME='ragg2 -v~commit?"'
CMDS='!!ragg2 -v~commit?'
BROKEN=1
EXPECT='1
'
run_test

NAME='ragg2 -h~Usage?"'
CMDS='!!ragg2 -h~Usage?'
BROKEN=1
EXPECT='1
'
run_test