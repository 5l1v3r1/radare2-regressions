#!/bin/sh
for a in . .. ../.. ; do [ -e $a/tests.sh ] && . $a/tests.sh ; done

NAME='PE: corkami 96workingsections.exe - open and analyze'
FILE=../../bins/pe/96workingsections.exe
ARGS='-A'
CMDS="q!"
EXPECT=''
IGNORE_ERR=1
run_test

IGNORE_ERR=
NAME='PE: corkami 96workingsections.exe - entrypoint'
FILE=../../bins/pe/96workingsections.exe
CMDS='
s
'
EXPECT='0x461000
'
IGNORE_ERR=1
run_test

NAME='PE: corkami 96workingsections.exe - section list'
FILE=../../bins/pe/96workingsections.exe
ARGS='-n'
CMDS="!rabin2 -S ${FILE}"
EXPECT='[Sections]
idx=00 vaddr=0x00001200 paddr=0x00001200 sz=512 vsz=512 perm=--wx name=
idx=01 vaddr=0x00001400 paddr=0x00001400 sz=512 vsz=512 perm=--wx name=
idx=02 vaddr=0x00001600 paddr=0x00001600 sz=512 vsz=512 perm=--wx name=
idx=03 vaddr=0x00001800 paddr=0x00001800 sz=512 vsz=512 perm=--wx name=
idx=04 vaddr=0x00001a00 paddr=0x00001a00 sz=512 vsz=512 perm=--wx name=
idx=05 vaddr=0x00001c00 paddr=0x00001c00 sz=512 vsz=512 perm=--wx name=
idx=06 vaddr=0x00001e00 paddr=0x00001e00 sz=512 vsz=512 perm=--wx name=
idx=07 vaddr=0x00002000 paddr=0x00002000 sz=512 vsz=512 perm=--wx name=
idx=08 vaddr=0x00002200 paddr=0x00002200 sz=512 vsz=512 perm=--wx name=
idx=09 vaddr=0x00002400 paddr=0x00002400 sz=512 vsz=512 perm=--wx name=
idx=10 vaddr=0x00002600 paddr=0x00002600 sz=512 vsz=512 perm=--wx name=
idx=11 vaddr=0x00002800 paddr=0x00002800 sz=512 vsz=512 perm=--wx name=
idx=12 vaddr=0x00002a00 paddr=0x00002a00 sz=512 vsz=512 perm=--wx name=
idx=13 vaddr=0x00002c00 paddr=0x00002c00 sz=512 vsz=512 perm=--wx name=
idx=14 vaddr=0x00002e00 paddr=0x00002e00 sz=512 vsz=512 perm=--wx name=
idx=15 vaddr=0x00003000 paddr=0x00003000 sz=512 vsz=512 perm=--wx name=
idx=16 vaddr=0x00003200 paddr=0x00003200 sz=512 vsz=512 perm=--wx name=
idx=17 vaddr=0x00003400 paddr=0x00003400 sz=512 vsz=512 perm=--wx name=
idx=18 vaddr=0x00003600 paddr=0x00003600 sz=512 vsz=512 perm=--wx name=
idx=19 vaddr=0x00003800 paddr=0x00003800 sz=512 vsz=512 perm=--wx name=
idx=20 vaddr=0x00003a00 paddr=0x00003a00 sz=512 vsz=512 perm=--wx name=
idx=21 vaddr=0x00003c00 paddr=0x00003c00 sz=512 vsz=512 perm=--wx name=
idx=22 vaddr=0x00003e00 paddr=0x00003e00 sz=512 vsz=512 perm=--wx name=
idx=23 vaddr=0x00004000 paddr=0x00004000 sz=512 vsz=512 perm=--wx name=
idx=24 vaddr=0x00004200 paddr=0x00004200 sz=512 vsz=512 perm=--wx name=
idx=25 vaddr=0x00004400 paddr=0x00004400 sz=512 vsz=512 perm=--wx name=
idx=26 vaddr=0x00004600 paddr=0x00004600 sz=512 vsz=512 perm=--wx name=
idx=27 vaddr=0x00004800 paddr=0x00004800 sz=512 vsz=512 perm=--wx name=
idx=28 vaddr=0x00004a00 paddr=0x00004a00 sz=512 vsz=512 perm=--wx name=
idx=29 vaddr=0x00004c00 paddr=0x00004c00 sz=512 vsz=512 perm=--wx name=
idx=30 vaddr=0x00004e00 paddr=0x00004e00 sz=512 vsz=512 perm=--wx name=
idx=31 vaddr=0x00005000 paddr=0x00005000 sz=512 vsz=512 perm=--wx name=
idx=32 vaddr=0x00005200 paddr=0x00005200 sz=512 vsz=512 perm=--wx name=
idx=33 vaddr=0x00005400 paddr=0x00005400 sz=512 vsz=512 perm=--wx name=
idx=34 vaddr=0x00005600 paddr=0x00005600 sz=512 vsz=512 perm=--wx name=
idx=35 vaddr=0x00005800 paddr=0x00005800 sz=512 vsz=512 perm=--wx name=
idx=36 vaddr=0x00005a00 paddr=0x00005a00 sz=512 vsz=512 perm=--wx name=
idx=37 vaddr=0x00005c00 paddr=0x00005c00 sz=512 vsz=512 perm=--wx name=
idx=38 vaddr=0x00005e00 paddr=0x00005e00 sz=512 vsz=512 perm=--wx name=
idx=39 vaddr=0x00006000 paddr=0x00006000 sz=512 vsz=512 perm=--wx name=
idx=40 vaddr=0x00006200 paddr=0x00006200 sz=512 vsz=512 perm=--wx name=
idx=41 vaddr=0x00006400 paddr=0x00006400 sz=512 vsz=512 perm=--wx name=
idx=42 vaddr=0x00006600 paddr=0x00006600 sz=512 vsz=512 perm=--wx name=
idx=43 vaddr=0x00006800 paddr=0x00006800 sz=512 vsz=512 perm=--wx name=
idx=44 vaddr=0x00006a00 paddr=0x00006a00 sz=512 vsz=512 perm=--wx name=
idx=45 vaddr=0x00006c00 paddr=0x00006c00 sz=512 vsz=512 perm=--wx name=
idx=46 vaddr=0x00006e00 paddr=0x00006e00 sz=512 vsz=512 perm=--wx name=
idx=47 vaddr=0x00007000 paddr=0x00007000 sz=512 vsz=512 perm=--wx name=
idx=48 vaddr=0x00007200 paddr=0x00007200 sz=512 vsz=512 perm=--wx name=
idx=49 vaddr=0x00007400 paddr=0x00007400 sz=512 vsz=512 perm=--wx name=
idx=50 vaddr=0x00007600 paddr=0x00007600 sz=512 vsz=512 perm=--wx name=
idx=51 vaddr=0x00007800 paddr=0x00007800 sz=512 vsz=512 perm=--wx name=
idx=52 vaddr=0x00007a00 paddr=0x00007a00 sz=512 vsz=512 perm=--wx name=
idx=53 vaddr=0x00007c00 paddr=0x00007c00 sz=512 vsz=512 perm=--wx name=
idx=54 vaddr=0x00007e00 paddr=0x00007e00 sz=512 vsz=512 perm=--wx name=
idx=55 vaddr=0x00008000 paddr=0x00008000 sz=512 vsz=512 perm=--wx name=
idx=56 vaddr=0x00008200 paddr=0x00008200 sz=512 vsz=512 perm=--wx name=
idx=57 vaddr=0x00008400 paddr=0x00008400 sz=512 vsz=512 perm=--wx name=
idx=58 vaddr=0x00008600 paddr=0x00008600 sz=512 vsz=512 perm=--wx name=
idx=59 vaddr=0x00008800 paddr=0x00008800 sz=512 vsz=512 perm=--wx name=
idx=60 vaddr=0x00008a00 paddr=0x00008a00 sz=512 vsz=512 perm=--wx name=
idx=61 vaddr=0x00008c00 paddr=0x00008c00 sz=512 vsz=512 perm=--wx name=
idx=62 vaddr=0x00008e00 paddr=0x00008e00 sz=512 vsz=512 perm=--wx name=
idx=63 vaddr=0x00009000 paddr=0x00009000 sz=512 vsz=512 perm=--wx name=
idx=64 vaddr=0x00009200 paddr=0x00009200 sz=512 vsz=512 perm=--wx name=
idx=65 vaddr=0x00009400 paddr=0x00009400 sz=512 vsz=512 perm=--wx name=
idx=66 vaddr=0x00009600 paddr=0x00009600 sz=512 vsz=512 perm=--wx name=
idx=67 vaddr=0x00009800 paddr=0x00009800 sz=512 vsz=512 perm=--wx name=
idx=68 vaddr=0x00009a00 paddr=0x00009a00 sz=512 vsz=512 perm=--wx name=
idx=69 vaddr=0x00009c00 paddr=0x00009c00 sz=512 vsz=512 perm=--wx name=
idx=70 vaddr=0x00009e00 paddr=0x00009e00 sz=512 vsz=512 perm=--wx name=
idx=71 vaddr=0x0000a000 paddr=0x0000a000 sz=512 vsz=512 perm=--wx name=
idx=72 vaddr=0x0000a200 paddr=0x0000a200 sz=512 vsz=512 perm=--wx name=
idx=73 vaddr=0x0000a400 paddr=0x0000a400 sz=512 vsz=512 perm=--wx name=
idx=74 vaddr=0x0000a600 paddr=0x0000a600 sz=512 vsz=512 perm=--wx name=
idx=75 vaddr=0x0000a800 paddr=0x0000a800 sz=512 vsz=512 perm=--wx name=
idx=76 vaddr=0x0000aa00 paddr=0x0000aa00 sz=512 vsz=512 perm=--wx name=
idx=77 vaddr=0x0000ac00 paddr=0x0000ac00 sz=512 vsz=512 perm=--wx name=
idx=78 vaddr=0x0000ae00 paddr=0x0000ae00 sz=512 vsz=512 perm=--wx name=
idx=79 vaddr=0x0000b000 paddr=0x0000b000 sz=512 vsz=512 perm=--wx name=
idx=80 vaddr=0x0000b200 paddr=0x0000b200 sz=512 vsz=512 perm=--wx name=
idx=81 vaddr=0x0000b400 paddr=0x0000b400 sz=512 vsz=512 perm=--wx name=
idx=82 vaddr=0x0000b600 paddr=0x0000b600 sz=512 vsz=512 perm=--wx name=
idx=83 vaddr=0x0000b800 paddr=0x0000b800 sz=512 vsz=512 perm=--wx name=
idx=84 vaddr=0x0000ba00 paddr=0x0000ba00 sz=512 vsz=512 perm=--wx name=
idx=85 vaddr=0x0000bc00 paddr=0x0000bc00 sz=512 vsz=512 perm=--wx name=
idx=86 vaddr=0x0000be00 paddr=0x0000be00 sz=512 vsz=512 perm=--wx name=
idx=87 vaddr=0x0000c000 paddr=0x0000c000 sz=512 vsz=512 perm=--wx name=
idx=88 vaddr=0x0000c200 paddr=0x0000c200 sz=512 vsz=512 perm=--wx name=
idx=89 vaddr=0x0000c400 paddr=0x0000c400 sz=512 vsz=512 perm=--wx name=
idx=90 vaddr=0x0000c600 paddr=0x0000c600 sz=512 vsz=512 perm=--wx name=
idx=91 vaddr=0x0000c800 paddr=0x0000c800 sz=512 vsz=512 perm=--wx name=
idx=92 vaddr=0x0000ca00 paddr=0x0000ca00 sz=512 vsz=512 perm=--wx name=
idx=93 vaddr=0x0000cc00 paddr=0x0000cc00 sz=512 vsz=512 perm=--wx name=
idx=94 vaddr=0x0000ce00 paddr=0x0000ce00 sz=512 vsz=512 perm=--wx name=
idx=95 vaddr=0x0000d000 paddr=0x0000d000 sz=512 vsz=512 perm=--wx name=

96 sections
'
IGNORE_ERR=1
run_test


